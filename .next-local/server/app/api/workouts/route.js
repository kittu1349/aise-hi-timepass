"use strict";(()=>{var e={};e.id=224,e.ids=[224],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},33172:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>k,serverHooks:()=>y,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>f});var o={};r.r(o),r.d(o,{GET:()=>l,POST:()=>p,dynamic:()=>d});var a=r(95419),n=r(69108),s=r(99678),i=r(78070),u=r(9108),c=r(43729);let d="force-dynamic";async function l(e){try{let{userId:t}=(0,c.u)(!0),r=e.nextUrl.searchParams.get("date"),o={userId:t};if(r){let e=new Date(r),t=new Date(r);t.setDate(t.getDate()+1),o.date={gte:e,lt:t}}let a=await u._.workout.findMany({where:o,include:{workoutType:!0},orderBy:{createdAt:"desc"}});return i.Z.json(a)}catch(e){return i.Z.json({error:"Failed to fetch workouts"},{status:500})}}async function p(e){try{let{userId:t,setCookie:r}=(0,c.u)(),{date:o,workoutTypeId:a,duration:n,caloriesBurned:s,intensity:d,notes:l}=await e.json();if(!o||!a||"number"!=typeof n)return i.Z.json({error:"Invalid payload"},{status:400});if(!t)return i.Z.json({error:"Unauthorized"},{status:401});let p=await u._.workoutType.findFirst({where:{id:a,userId:t}});if(!p)return i.Z.json({error:"Workout type not found"},{status:404});let k=await u._.workout.create({data:{date:new Date(o),duration:n,caloriesBurned:"number"==typeof s?s:Math.round(n*p.caloriesPerMin),intensity:d||"MODERATE",notes:l,userId:t,workoutTypeId:a},include:{workoutType:!0}}),m=i.Z.json(k,{status:201});return r&&m.cookies.set("uid",t,{httpOnly:!0,sameSite:"lax",maxAge:31536e3}),m}catch(e){return i.Z.json({error:"Failed to create workout"},{status:500})}}let k=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/workouts/route",pathname:"/api/workouts",filename:"route",bundlePath:"app/api/workouts/route"},resolvedPagePath:"C:\\Users\\kittu\\OneDrive\\Desktop\\deficit tracker\\nextjs\\app\\api\\workouts\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:w,serverHooks:y,headerHooks:h,staticGenerationBailout:f}=k,g="/api/workouts/route";function x(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:w})}},9108:(e,t,r)=>{r.d(t,{_:()=>a});let o=require("@prisma/client"),a=globalThis.prisma??new o.PrismaClient({log:["error"]})},43729:(e,t,r)=>{r.d(t,{u:()=>a});var o=r(32455);function a(e=!1){let t=(0,o.cookies)(),r=t.get("uid")?.value;return r?{userId:r,setCookie:!1}:e?{userId:globalThis.crypto?.randomUUID?.()||Math.random().toString(36).slice(2),setCookie:!0}:{userId:null,setCookie:!1}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206,455],()=>r(33172));module.exports=o})();