"use strict";(()=>{var e={};e.id=442,e.ids=[442],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},90818:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>E,originalPathname:()=>v,patchFetch:()=>A,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>T});var i={};r.r(i),r.d(i,{GET:()=>d,PUT:()=>p,dynamic:()=>c});var n=r(95419),o=r(69108),u=r(99678),a=r(78070),l=r(9108),s=r(43729);let c="force-dynamic";async function d(){try{let{userId:e}=(0,s.u)(!1);if(!e)return a.Z.json({error:"Unauthorized"},{status:401});let t=await l._.user.findUnique({where:{id:e}});return a.Z.json(t)}catch(e){return a.Z.json({error:"Failed to fetch profile"},{status:500})}}async function p(e){try{let{userId:p}=(0,s.u)(!1);if(!p)return a.Z.json({error:"Unauthorized"},{status:401});let{name:m,email:g,age:h,gender:f,height:E,weight:T,goalWeight:v,activityLevel:A,deficitSpeed:x}=await e.json();if(!g)return a.Z.json({error:"Email is required"},{status:400});let b=null,N=null,j=null;if(h&&f&&E&&T&&A){var t,r,i,n,o,u,c,d;t=Number(h),r=String(f),i=Number(T),n=Number(E),o=b="male"===r.toLowerCase()?10*i+6.25*n-5*t+5:10*i+6.25*n-5*t-161,u=String(A),c=N=o*(({SEDENTARY:1.2,LIGHTLY_ACTIVE:1.375,MODERATELY_ACTIVE:1.55,VERY_ACTIVE:1.725,EXTRA_ACTIVE:1.9})[u]||1.2),d=String(x||"MODERATE"),j=c+(({MAINTENANCE:0,SLOW:-250,MODERATE:-500,FAST:-750,VERY_FAST:-1e3})[d]||-500)}let y=await l._.user.upsert({where:{id:p},update:{name:m,email:g,age:h?Number(h):null,gender:f||null,height:E?Number(E):null,weight:T?Number(T):null,goalWeight:v?Number(v):null,activityLevel:A||null,deficitSpeed:x||null,bmr:b,tdee:N,targetCalories:j},create:{id:p,name:m,email:g,age:h?Number(h):null,gender:f||null,height:E?Number(E):null,weight:T?Number(T):null,goalWeight:v?Number(v):null,activityLevel:A||null,deficitSpeed:x||null,bmr:b,tdee:N,targetCalories:j}});return a.Z.json(y)}catch(e){return a.Z.json({error:"Failed to save profile"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/profile/route",pathname:"/api/profile",filename:"route",bundlePath:"app/api/profile/route"},resolvedPagePath:"C:\\Users\\kittu\\OneDrive\\Desktop\\deficit tracker\\nextjs\\app\\api\\profile\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:f,headerHooks:E,staticGenerationBailout:T}=m,v="/api/profile/route";function A(){return(0,u.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},9108:(e,t,r)=>{r.d(t,{_:()=>n});let i=require("@prisma/client"),n=globalThis.prisma??new i.PrismaClient({log:["error"]})},43729:(e,t,r)=>{r.d(t,{u:()=>n});var i=r(32455);function n(e=!1){let t=(0,i.cookies)(),r=t.get("uid")?.value;return r?{userId:r,setCookie:!1}:e?{userId:globalThis.crypto?.randomUUID?.()||Math.random().toString(36).slice(2),setCookie:!0}:{userId:null,setCookie:!1}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[638,206,455],()=>r(90818));module.exports=i})();